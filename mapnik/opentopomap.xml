<?xml version="1.0" encoding="utf-8"?>
<!-- TODO:
	- waterfall
	- label positions places
	- railway bridges for others than simple rails
	- generalize rivers
-->
<!DOCTYPE Map
[
	<!ENTITY basemap-relief SYSTEM "styles-otm/basemap-relief.xml">
	<!ENTITY landuse-lowzoom SYSTEM "styles-otm/landuse-lowzoom.xml">
	<!ENTITY landuse SYSTEM "styles-otm/landuse.xml">
	<!ENTITY landuse-over-hillshade SYSTEM "styles-otm/landuse-over-hillshade.xml">
	<!ENTITY hillshade SYSTEM "styles-otm/hillshade.xml">
	<!ENTITY basemap-sea SYSTEM "styles-otm/basemap-sea.xml">
	<!ENTITY water-casing-lowzoom SYSTEM "styles-otm/water-casing-lowzoom.xml">
	<!ENTITY water-fill-lowzoom SYSTEM "styles-otm/water-fill-lowzoom.xml">
	<!ENTITY waterway-lines-lowzoom SYSTEM "styles-otm/waterway-lines-lowzoom.xml">
	<!ENTITY waterway-lines SYSTEM "styles-otm/waterway-lines.xml">
	<!ENTITY waterway-polygons-casing SYSTEM "styles-otm/waterway-polygons-casing.xml">
	<!ENTITY waterway-polygons-fill SYSTEM "styles-otm/waterway-polygons-fill.xml">
	<!ENTITY water-areas SYSTEM "styles-otm/water-areas.xml">
	<!ENTITY landuse-over-water SYSTEM "styles-otm/landuse-over-water.xml">
	<!ENTITY road-areas SYSTEM "styles-otm/road-areas.xml">
	<!ENTITY water-weir SYSTEM "styles-otm/water-weir.xml">
	<!ENTITY waterway-arrows SYSTEM "styles-otm/waterway-arrows.xml">
	<!ENTITY tunnels-casing SYSTEM "styles-otm/tunnels-casing.xml">
	<!ENTITY tunnels-fill SYSTEM "styles-otm/tunnels-fill.xml">
	<!ENTITY tunnels-middle SYSTEM "styles-otm/tunnels-middle.xml">
	<!ENTITY cliffs SYSTEM "styles-otm/cliffs.xml">
	<!ENTITY buildings SYSTEM "styles-otm/buildings.xml">
	<!ENTITY areas SYSTEM "styles-otm/areas.xml">
	<!ENTITY contours SYSTEM "styles-otm/contours.xml">
	<!ENTITY borders-lowzoom SYSTEM "styles-otm/borders-lowzoom.xml">
	<!ENTITY borders SYSTEM "styles-otm/borders.xml">
	<!ENTITY barriers SYSTEM "styles-otm/barriers.xml">
	<!ENTITY railways-lowzoom SYSTEM "styles-otm/railways-lowzoom.xml">
	<!ENTITY railways-embankment SYSTEM "styles-otm/railways-embankment.xml">
	<!ENTITY railways SYSTEM "styles-otm/railways.xml">
	<!ENTITY airports-casing SYSTEM "styles-otm/airports-casing.xml">
	<!ENTITY airports-fill SYSTEM "styles-otm/airports-fill.xml">
	<!ENTITY airports-poly SYSTEM "styles-otm/airports-poly.xml">
	<!ENTITY roads-casing-lowzoom SYSTEM "styles-otm/roads-casing-lowzoom.xml">
	<!ENTITY roads-fill-lowzoom SYSTEM "styles-otm/roads-fill-lowzoom.xml">
	<!ENTITY roads-casing SYSTEM "styles-otm/roads-casing.xml">
	<!ENTITY roads-fill SYSTEM "styles-otm/roads-fill.xml">
	<!ENTITY trams SYSTEM "styles-otm/trams.xml">
	<!ENTITY housenumbers-poly SYSTEM "styles-otm/housenumbers-poly.xml">
	<!ENTITY housenumbers-point SYSTEM "styles-otm/housenumbers-point.xml">
	<!ENTITY road-names-text SYSTEM "styles-otm/road-names-text.xml">
	<!ENTITY railway-points SYSTEM "styles-otm/railway-points.xml">
	<!ENTITY symbols-road SYSTEM "styles-otm/symbols-road.xml">
	<!ENTITY ferry-routes SYSTEM "styles-otm/ferry-routes.xml">
	<!ENTITY railway-bridges-casing SYSTEM "styles-otm/railway-bridges-casing.xml">
	<!ENTITY railway-bridges SYSTEM "styles-otm/railway-bridges.xml">
	<!ENTITY bridges-casing SYSTEM "styles-otm/bridges-casing.xml">
	<!ENTITY bridges-fill SYSTEM "styles-otm/bridges-fill.xml">
	<!ENTITY bridges-middle SYSTEM "styles-otm/bridges-middle.xml">
	<!ENTITY aerialways SYSTEM "styles-otm/aerialways.xml">
	<!ENTITY powerlines SYSTEM "styles-otm/powerlines.xml">
	<!ENTITY powertowers SYSTEM "styles-otm/powertowers.xml">
	<!ENTITY text-natural-line SYSTEM "styles-otm/text-natural-line.xml">
	<!ENTITY text-cities-lowzoom SYSTEM "styles-otm/text-cities-lowzoom.xml">
	<!ENTITY text-cities SYSTEM "styles-otm/text-cities.xml">
	<!ENTITY text-towns SYSTEM "styles-otm/text-towns.xml">
	<!ENTITY text-villages SYSTEM "styles-otm/text-villages.xml">
    <!ENTITY symbols-sport SYSTEM "styles-otm/symbols-sport.xml">
	<!ENTITY symbols-stations SYSTEM "styles-otm/symbols-stations.xml">
    <!ENTITY text-water-lowzoom SYSTEM "styles-otm/text-water-lowzoom.xml">
	<!ENTITY text-glacier-lowzoom SYSTEM "styles-otm/text-glacier-lowzoom.xml">
	<!ENTITY text-natural-poly SYSTEM "styles-otm/text-natural-poly.xml">
    <!ENTITY symbols-peaks SYSTEM "styles-otm/symbols-peaks.xml">
    <!ENTITY text-peaks SYSTEM "styles-otm/text-peaks.xml">
	<!ENTITY symbols-1 SYSTEM "styles-otm/symbols-1.xml">
	<!ENTITY symbols-2 SYSTEM "styles-otm/symbols-2.xml">
	<!ENTITY symbols-poly SYSTEM "styles-otm/symbols-poly.xml">
	<!ENTITY symbols-point SYSTEM "styles-otm/symbols-point.xml">
	<!ENTITY symbols-viewpoint SYSTEM "styles-otm/symbols-viewpoint.xml">
	<!ENTITY symbols-saddle SYSTEM "styles-otm/symbols-saddle.xml">
	<!ENTITY text-roads-ref SYSTEM "styles-otm/text-roads-ref.xml">
	<!ENTITY text-waterways SYSTEM "styles-otm/text-waterways.xml">
	<!ENTITY test SYSTEM "styles-otm/test.xml">
	<!ENTITY natural-areas SYSTEM "styles-otm/natural-areas.xml">
        <!ENTITY text-natural-areas-lowzoom SYSTEM "styles-otm/text-natural-areas-lowzoom.xml">
	<!ENTITY % entities SYSTEM "inc/entities.xml.inc">
	%entities;
]>

<!-- background-color:
	zoom 0...8: #117803
	zoom 9+: e0e0e0
-->
<Map background-color="#e0e0e0" srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs +over" buffer-size="256">
	<!-- style definitions -->
	&fontset-settings;

	&landuse-lowzoom;
	&landuse;
	&landuse-over-hillshade;
	&water-casing-lowzoom;
	&water-fill-lowzoom;
	&waterway-lines-lowzoom;
	&waterway-lines;
	&waterway-polygons-casing;
	&waterway-polygons-fill;
	&water-areas;
	&landuse-over-water;
	&road-areas;
	&water-weir;
	&waterway-arrows;
	&tunnels-casing;
	&tunnels-fill;
	&tunnels-middle;
	&cliffs;
	&buildings;
	&areas;
	&contours;
	&borders-lowzoom;
	&borders;
	&barriers;
	&railways-lowzoom;
	&railways-embankment;
	&railways;
	&airports-casing;
	&airports-fill;
	&airports-poly;
	&roads-casing-lowzoom;
	&roads-fill-lowzoom;
	&roads-casing;
	&roads-fill;
	&trams;
	&railway-points;
	&symbols-road;
	&housenumbers-poly;
	&housenumbers-point;
	&ferry-routes;
	&railway-bridges-casing;
	&railway-bridges;
	&road-names-text;
	&bridges-casing;
	&bridges-fill;
	&bridges-middle;
	&aerialways;
	&powerlines;
	&powertowers;
	&text-natural-line;
	&text-cities-lowzoom;
	&text-cities;
	&text-towns;
	&text-villages;
    &symbols-sport;
	&symbols-stations;
    &text-water-lowzoom;
	&text-glacier-lowzoom;
    &text-natural-poly;
    &symbols-peaks;
    &text-peaks;
    &symbols-saddle;
    &symbols-1;
	&symbols-2;
	&symbols-poly;
	&symbols-point;
	&symbols-viewpoint;
	&text-roads-ref;
	&text-waterways;
	&test;
	&natural-areas;
        &text-natural-areas-lowzoom;

	<!-- layers -->
	
	&basemap-relief;
	
	<Layer name="water-lowzoom">
		<StyleName>water-casing-lowzoom</StyleName>
		<StyleName>water-fill-lowzoom</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,"natural",water,waterway,way_area,name FROM water) AS water </Parameter>
			<Parameter name="dbname">lowzoom</Parameter>
			&postgis-settings;
		</Datasource>
	</Layer>
	
	<Layer name="waterway-lines">
		<StyleName>waterway-lines</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,"CEMT",intermittent,motorboat,tunnel,waterway FROM planet_osm_line) AS water </Parameter>
			<Parameter name="dbname">gis</Parameter>
			&postgis-settings;
		</Datasource>
	</Layer>

	<Layer name="water-polygons">
		<StyleName>waterway-polygons-casing</StyleName>
		<StyleName>waterway-polygons-fill</StyleName>
		<StyleName>water-areas</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,"CEMT",motorboat,"natural",landuse,leisure,waterway,intermittent,way_area FROM planet_osm_polygon) AS water </Parameter>
			<Parameter name="dbname">gis</Parameter>
			&postgis-settings;
		</Datasource>
	</Layer>
	
	<Layer name="landuse-over-water">
		<StyleName>landuse-over-water</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,"natural",wetland FROM planet_osm_polygon) AS landuse </Parameter>
			<Parameter name="dbname">gis</Parameter>
			&postgis-settings;
		</Datasource>
	</Layer>

	<Layer name="borders-lowzoom">
		<StyleName>borders-lowzoom</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,boundary,admin_level FROM borders) AS borders</Parameter>
			<Parameter name="dbname">lowzoom</Parameter>
			&postgis-settings;
		</Datasource>
	</Layer>
	
	<Layer name="borders">
		<StyleName>borders</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,boundary,admin_level,name FROM planet_osm_line WHERE boundary IN ('administrative')) AS borders </Parameter>
			<Parameter name="dbname">gis</Parameter>
			&postgis-settings;
		</Datasource>
	</Layer>

	<Layer name="text-cities" clear-label-cache="on">
		<StyleName>text-cities</StyleName>
		<StyleName>text-towns</StyleName>
		<StyleName>text-villages</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,admin_level,name,capital,'('&#124;&#124;substring(ele from '^[\d]+')&#124;&#124;')' as ele,place,population::INTEGER FROM planet_osm_point WHERE (population IS NULL OR population SIMILAR TO '[[:digit:]]+') AND place IN ('city','town','village','suburb','hamlet','isolated_dwelling','locality') ORDER BY (CASE WHEN place='city' THEN 0 WHEN place='town' THEN 1 WHEN place='village' THEN 2 ELSE 3 END) ASC, (CASE WHEN population IS NUll THEN 0 WHEN population similar to '[[:digit:]]+' THEN population::integer ELSE 0 END) DESC
		  ) AS names</Parameter>
			<Parameter name="dbname">gis</Parameter>
			&postgis-settings;
		</Datasource>
	</Layer>
	
	<Layer name="natural-areas">
		<StyleName>natural-areas</StyleName>
		<Datasource>
			<Parameter name="table">(SELECT way,"region:type" as region_type from  planet_osm_polygon WHERE "region:type"='mountain_area') AS test</Parameter>
			<Parameter name="dbname">gis</Parameter>
			&postgis-settings;
		</Datasource>
	</Layer>
    <Layer name="text-natural-areas-lowzoom">
		<StyleName>text-natural-areas-lowzoom</StyleName>
		<Datasource>
            <Parameter name="table">(SELECT way,' '&#124;&#124;name&#124;&#124;' ' AS name,areatype,way_area,nextregionsize,subregionsize FROM naturalarealabels) AS naturallabels </Parameter>
			<Parameter name="dbname">lowzoom</Parameter>
			&postgis-settings;
		</Datasource>
    </Layer>
	
</Map>

<!--
macros:
	!scale_denominator!
	!bbox!
-->
